<IfModule mod_ssl.c>
    <VirtualHost *:443>
        ServerAdmin <SERVERADMIN>

        DocumentRoot <BK_PATH>

        <Proxy *>
            Require all granted
        </Proxy>

        ProxyPass / http://localhost:<BK_AJAX_PORT>/ retry=0
        ProxyPassReverse / http://localhost:<BK_AJAX_PORT>/ retry=0

        ErrorLog ${APACHE_LOG_DIR}/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/access.log combined

        SSLEngine on
        SSLCertificateFile    /etc/ssl/localcerts/apache2/bk_certificate.pem
        SSLCertificateKeyFile /etc/ssl/localcerts/apache2/bk_certificate.key

        <FilesMatch "\.(cgi|shtml|phtml|php)$">
            SSLOptions +StdEnvVars
        </FilesMatch>
        <Directory /usr/lib/cgi-bin>
            SSLOptions +StdEnvVars
        </Directory>

        BrowserMatch "MSIE [2-6]" \
        nokeepalive ssl-unclean-shutdown \
        downgrade-1.0 force-response-1.0
        BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown
    </VirtualHost>

    <VirtualHost *:4443>
        ServerAdmin <SERVERADMIN>

        DocumentRoot <BK_PATH>

        <Location />
            Require all denied
        </Location>

        <Location /ws>
            Require all granted
        </Location>

        <Proxy *>
            Require all granted
        </Proxy>

        ProxyPass /ws ws://localhost:<BK_WS_PORT>/ws retry=0
        ProxyPassReverse /ws ws://localhost:<BK_WS_PORT>/ws retry=0

        ErrorLog ${APACHE_LOG_DIR}/ws_error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/ws_access.log combined

        SSLEngine on
        SSLCertificateFile    /etc/ssl/localcerts/apache2/bk_certificate.pem
        SSLCertificateKeyFile /etc/ssl/localcerts/apache2/bk_certificate.key

        <FilesMatch "\.(cgi|shtml|phtml|php)$">
            SSLOptions +StdEnvVars
        </FilesMatch>
        <Directory /usr/lib/cgi-bin>
            SSLOptions +StdEnvVars
        </Directory>

        BrowserMatch "MSIE [2-6]" \
        nokeepalive ssl-unclean-shutdown \
        downgrade-1.0 force-response-1.0
        BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown
    </VirtualHost>
</IfModule>
